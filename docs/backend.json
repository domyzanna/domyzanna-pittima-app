{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Deadline Dynamo application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity, matching Firebase Auth UID."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "displayName": {
          "type": "string",
          "description": "User's display name."
        }
      },
      "required": [
        "id",
        "email"
      ]
    },
    "Deadline": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Deadline",
      "type": "object",
      "description": "Represents a deadline or reminder in the Deadline Dynamo application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Deadline entity."
        },
        "userId": {
          "type": "string",
          "description": "The UID of the user who owns this deadline."
        },
        "categoryId": {
          "type": "string",
          "description": "The ID of the category this deadline belongs to."
        },
        "name": {
          "type": "string",
          "description": "Name of the deadline."
        },
        "description": {
          "type": "string",
          "description": "A more detailed description of the deadline."
        },
        "expirationDate": {
          "type": "string",
          "description": "Date and time when the deadline expires (ISO 8601 format).",
          "format": "date-time"
        },
        "recurrence": {
          "type": "string",
          "description": "Recurrence pattern for the deadline.",
          "enum": [
            "una-tantum",
            "mensile",
            "trimestrale",
            "semestrale",
            "annuale"
          ]
        },
        "isCompleted": {
          "type": "boolean",
          "description": "Indicates if the deadline has been completed."
        }
      },
      "required": [
        "id",
        "userId",
        "categoryId",
        "name",
        "expirationDate",
        "recurrence",
        "isCompleted"
      ]
    },
    "Category": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Category",
      "type": "object",
      "description": "Represents a user-defined category for grouping deadlines.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Category entity."
        },
        "userId": {
          "type": "string",
          "description": "The UID of the user who owns this category."
        },
        "name": {
          "type": "string",
          "description": "Name of the category."
        },
        "icon": {
          "type": "string",
          "description": "Name of the lucide-react icon for this category."
        }
      },
      "required": [
        "id",
        "userId",
        "name",
        "icon"
      ]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores public user profile information. The `userId` matches the Firebase Auth UID.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/deadlines/{deadlineId}",
        "definition": {
          "entityName": "Deadline",
          "schema": {
            "$ref": "#/backend/entities/Deadline"
          },
          "description": "Stores deadlines owned by a specific user. The `userId` in the path ensures data isolation.",
          "params": [
            {
              "name": "userId",
              "description": "The owner of the subcollection."
            },
            {
              "name": "deadlineId",
              "description": "The unique identifier for the deadline."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/categories/{categoryId}",
        "definition": {
          "entityName": "Category",
          "schema": {
            "$ref": "#/backend/entities/Category"
          },
          "description": "Stores categories created by a specific user. The `userId` in the path ensures data isolation.",
          "params": [
            {
              "name": "userId",
              "description": "The owner of the subcollection."
            },
            {
              "name": "categoryId",
              "description": "The unique identifier for the category."
            }
          ]
        }
      }
    ],
    "reasoning": "This structure enforces a strict user-ownership model by nesting all user-generated content (deadlines, categories) in subcollections under their unique user document. This simplifies security rules, enhances scalability, and improves query performance by allowing direct access to a user's data tree. Denormalizing the `userId` into documents is a key strategy for writing efficient and secure rules without needing extra database reads."
  }
}
